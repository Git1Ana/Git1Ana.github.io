<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Анастасия - Junior Full-stack разработчик</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Шапка с профилем -->
    <header>
        <div class="container">
            <div class="profile">
                <img src="https://images.unsplash.com/vector-1738925788085-ae22e9bf3f7e?q=80&w=2360&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Фото профиля" class="profile-img">
                <h1>Анастасия</h1>
                <p class="tagline">Junior Full-stack разработчик</p>
                <div class="social-links">
                    <a href="https://github.com/Git1Ana" target="_blank" title="GitHub">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="https://hh.ru/resume/b7dc1b3eff0f52567b0039ed1f576d30745375" target="_blank" title="Резюме на HeadHunter">
                        <i class="fab fa-headhunter"></i>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Обо мне -->
    <section id="about">
        <div class="container">
            <h2>Обо мне</h2>
            <div class="about-content">
                <div class="about-text">
                    <p>Я начинающий Full-stack разработчик с годом опыта работы на фрилансе. Владею стеком технологий для веб-разработки, включая Python, PHP, JavaScript и SQL. Имею практический опыт работы с базами данных PostgreSQL, а также сбора и обработки данных через API.</p>
                    
                    <p>Мой опыт включает разработку различных функций и разделов сайтов, внесение изменений в структуру баз данных и тестирование реализованных решений. Я умею не только писать код, но и визуализировать данные для презентации результатов, что помогает эффективно демонстрировать проделанную работу.</p>
                    
                    <div class="highlight">
                        <p>Ищу возможность присоединиться к сильной команде для работы над интересными проектами, где смогу применять и углублять свои знания, принося реальную пользу компании. Отличаюсь ответственностью, быстрой обучаемостью и готовностью решать нестандартные задачи.</p>
                    </div>
                    
                    <div class="education">
                        <h3>Образование</h3>
                        <div class="education-item">
                            <div class="education-title">Фундаментальная информатика и информационные технологии</div>
                            <div class="education-details">Государственный университет «Дубна», 2025</div>
                            <div>Высшее образование · Красный диплом</div>
                        </div>
                    </div>
                    
                    <div class="experience">
                        <h3>Опыт работы</h3>
                        <div class="timeline">
                            <div class="timeline-item">
                                <div class="timeline-date">Май 2024 — настоящее время</div>
                                <div class="timeline-title">Фрилансер</div>
                                <div class="timeline-desc">Разработка различных функций, разделов сайта или приложения; внесение и тестирование изменений в структуре базы данных</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="skills-container">
                    <div class="skill-category">
                        <h3><i class="fas fa-code"></i> Frontend</h3>
                        <div class="skill">
                            <div class="skill-info">
                                <span class="skill-name">HTML/CSS</span>
                                <span class="skill-percentage">85%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-level" data-width="85%"></div>
                            </div>
                        </div>
                        <div class="skill">
                            <div class="skill-info">
                                <span class="skill-name">JavaScript</span>
                                <span class="skill-percentage">80%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-level" data-width="80%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="skill-category">
                        <h3><i class="fas fa-server"></i> Backend</h3>
                        <div class="skill">
                            <div class="skill-info">
                                <span class="skill-name">Python</span>
                                <span class="skill-percentage">85%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-level" data-width="85%"></div>
                            </div>
                        </div>
                        <div class="skill">
                            <div class="skill-info">
                                <span class="skill-name">PHP</span>
                                <span class="skill-percentage">75%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-level" data-width="75%"></div>
                            </div>
                        </div>
                        <div class="skill">
                            <div class="skill-info">
                                <span class="skill-name">C#</span>
                                <span class="skill-percentage">70%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-level" data-width="70%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="skill-category">
                        <h3><i class="fas fa-database"></i> Базы данных & Другое</h3>
                        <div class="skill">
                            <div class="skill-info">
                                <span class="skill-name">SQL</span>
                                <span class="skill-percentage">80%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-level" data-width="80%"></div>
                            </div>
                        </div>
                        <div class="skill">
                            <div class="skill-info">
                                <span class="skill-name">PostgreSQL</span>
                                <span class="skill-percentage">75%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-level" data-width="75%"></div>
                            </div>
                        </div>
                        <div class="skill">
                            <div class="skill-info">
                                <span class="skill-name">Английский язык</span>
                                <span class="skill-percentage">70%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-level" data-width="70%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Мои работы -->
    <section id="projects" style="background-color: #f0f0f0;">
        <div class="container">
            <h2>Мои работы</h2>
            <div class="projects-grid">
                <!-- Проект 1 -->
                <div class="project-card">
                    <img src="pr1pic.png" alt="Проект 1" class="project-img" style="width: auto; height: 200px;">
                    <div class="project-content">
                        <h3 class="project-title">Анализатор востребованных навыков</h3>
                        <p class="project-desc">Full-stack приложение для автоматического анализа рынка труда с интеграцией HeadHunter API и Yandex GPT. Сокращает время анализа на 90%.</p>
                        <div class="project-links">
                            <a href="project1.html" class="btn">Демо</a>
                            <a href="#code-snippets" class="btn btn-outline" onclick="showCodeSnippets()">Код</a>
                        </div>
                    </div>
                </div>
                
                <!-- Проект 2 -->
                <div class="project-card">
                    <img src="pr2pic.png" alt="Проект 2" class="project-img" style="width: auto; height: 200px;">
                    <div class="project-content">
                        <h3 class="project-title">Интернет-магазин</h3>
                        <p class="project-desc">Разработка функционала корзины покупок и системы оплаты на PHP и JavaScript.</p>
                        <div class="project-links">
                            <a href="project2.html" class="btn">Демо</a>
                            <a href="#code-snippets" class="btn btn-outline" onclick="showShopCodeSnippets()">Код</a>
                        </div>
                    </div>
                </div>
                
                <!-- Проект 3 -->
                <div class="project-card">
                    <img src="pr3pic.png" alt="Проект 3" class="project-img" style="width: auto; height: 200px;">
                    <div class="project-content">
                        <h3 class="project-title">База данных клиентов</h3>
                        <p class="project-desc">Система управления клиентской базой с веб-интерфейсом, поиском, фильтрацией и визуализацией данных.</p>
                        <div class="project-links">
                            <a href="project3.html" class="btn">Демо</a>
                            <a href="#code-snippets" class="btn btn-outline" onclick="showDBCodeSnippets()">Код</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Контакты -->
    <section id="contact">
        <div class="container">
            <div class="contact-content">
                <div class="contact-info">
                    <div class="info-item">
                        <div class="info-icon"><i class="fas fa-envelope"></i></div>
                        <div>
                            <h3>Email</h3>
                            <p>anastazofi@gmail.com</p>
                        </div>
                    </div>
                    <div class="info-item">
                        <div class="info-icon"><i class="fas fa-map-marker-alt"></i></div>
                        <div>
                            <h3>Адрес</h3>
                            <p>Москва, Россия</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Футер -->
    <footer>
        <div class="container">
            <p>&copy; 2025 Анастасия. Junior Full-stack разработчик</p>
        </div>
    </footer>
    <!-- Модальное окно для показа кода -->
        <div id="codeModal" class="modal">
            <div class="modal-content" style="max-width: 800px; max-height: 80vh;">
                <span class="close" onclick="closeCodeModal()">&times;</span>
                <h2>Ключевые фрагменты кода</h2>
                <div class="code-tabs">
                    <button class="tab-button active" onclick="openTab(event, 'backendTab')">Backend (Python)</button>
                    <button class="tab-button" onclick="openTab(event, 'frontendTab')">Frontend (JS)</button>
                    <button class="tab-button" onclick="openTab(event, 'databaseTab')">База данных</button>
                </div>
                
                <div id="backendTab" class="tab-content active">
                    <h3>Интеграция с HeadHunter API</h3>
                    <pre><code class="language-python">def get_vacancies(keyword=None, titles=None, area=None, specialization=None,
                        experience=None, employment=None, schedule=None, publication_date=None):
            """Получение вакансий с HH API с пагинацией"""
            url = "https://api.hh.ru/vacancies"
            all_vacancies = []
            page = 0
            max_pages = 20

            base_params = {
                "text": " ".join(search_query),
                "area": area,
                "specialization": specialization,
                "experience": experience,
                "employment": employment,
                "schedule": schedule,
                "date_from": publication_date,
                "per_page": 100
            }
            
            base_params = {k: v for k, v in base_params.items() if v}

            try:
                while page < max_pages:
                    params = {**base_params, "page": page}
                    response = requests.get(url, params=params)
                    
                    if response.status_code != 200:
                        break

                    data = response.json()
                    vacancies = data.get('items', [])
                    if not vacancies:
                        break

                    for vacancy in vacancies:
                        vacancy_url = f"https://api.hh.ru/vacancies/{vacancy['id']}"
                        vacancy_response = requests.get(vacancy_url)
                        if vacancy_response.status_code == 200:
                            all_vacancies.append(vacancy_response.json())

                    page += 1

                return {'items': all_vacancies, 'found': data.get('found', 0)}
            except Exception as e:
                return {'items': all_vacancies, 'found': len(all_vacancies)}</code></pre>

                    <h3>Интеграция с Yandex GPT</h3>
                    <pre><code class="language-python">@app.route('/analyze_skills', methods=['POST'])
        def analyze_skills():
            """Анализ навыков с помощью Yandex GPT"""
            try:
                data = request.json
                prompt_type = data.get('prompt_type', 'technical')
                custom_prompt = data.get('custom_prompt', '')
                skills_data = data.get('skills_data', [])

                # Формирование промпта для ИИ
                skills_list = []
                for skill, stats in skills_data:
                    skills_list.append(f"{skill} ({stats['total']})")
                skills_text = "Список навыков:\n- " + "\n- ".join(skills_list[:200])

                # Отправка запроса к Yandex GPT
                headers = {
                    "Authorization": f"Api-Key {os.getenv('YANDEX_API_KEY')}",
                    "Content-Type": "application/json",
                }
                
                payload = {
                    "modelUri": f"gpt://{os.getenv('YANDEX_FOLDER_ID')}/yandexgpt-lite",
                    "messages": [{
                        "role": "user",
                        "text": final_prompt
                    }],
                    "completionOptions": {"maxTokens": 1000}
                }
                
                response = requests.post(
                    "https://llm.api.cloud.yandex.net/foundationModels/v1/completion",
                    headers=headers,
                    json=payload
                )
                response.raise_for_status()
                
                return jsonify({
                    "success": True,
                    "result": response.json()['result']['alternatives'][0]['message']['text'],
                    "tokens_used": response.json()['result']['usage']['totalTokens']
                })
                
            except Exception as e:
                return jsonify({"success": False, "error": str(e)}), 500</code></pre>
                </div>
                
                <div id="frontendTab" class="tab-content">
                    <h3>Визуализация графа навыков</h3>
                    <pre><code class="language-javascript">function visualizeSkillsGraph() {
            // Создание интерактивного графа связей между навыками
            const nodes = new vis.DataSet(skillsNodes);
            const edges = new vis.DataSet(skillsEdges);
            
            const container = document.getElementById('networkContainer');
            const data = { nodes, edges };
            
            const options = {
                nodes: {
                    shape: 'dot',
                    size: 30,
                    font: { size: 14, face: 'Tahoma' },
                    borderWidth: 2,
                    color: {
                        background: '#ffffff',
                        border: '#000000',
                        highlight: { background: '#fff', border: '#ff0000' }
                    }
                },
                edges: {
                    width: 2,
                    color: { color: '#000000', highlight: '#ff0000' },
                    smooth: true,
                    hoverWidth: 3
                },
                physics: { enabled: true },
                interaction: { hover: true }
            };
            
            new vis.Network(container, data, options);
        }</code></pre>

                    <h3>Обработка фильтров поиска</h3>
                    <pre><code class="language-javascript">function applySearchFilters() {
            const filters = {
                keyword: document.getElementById('keyword').value,
                titles: document.getElementById('titles').value,
                area: document.getElementById('selectedArea').value,
                specialization: document.getElementById('specialization').value,
                experience: document.getElementById('experience').value,
                employment: document.getElementById('employment').value,
                schedule: document.getElementById('schedule').value,
                publication_date: document.getElementById('publication_date').value
            };

            // Показ индикатора загрузки
            showLoadingIndicator();
            
            // Отправка запроса на сервер
            fetch('/get_vacancies', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(filters)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    renderVacancies(data.vacancies);
                    updateSkillsTable(data.skills);
                } else {
                    showError(data.message);
                }
            })
            .catch(error => {
                showError('Ошибка сети: ' + error.message);
            })
            .finally(() => {
                hideLoadingIndicator();
            });
        }</code></pre>
                </div>
                
                <div id="databaseTab" class="tab-content">
                    <h3>Схема базы данных</h3>
                    <pre><code class="language-sql">-- Основные таблицы для хранения данных анализа
        CREATE TABLE search_queries (
            id SERIAL PRIMARY KEY,
            keyword TEXT,
            titles TEXT,
            area TEXT,
            specialization TEXT,
            experience TEXT,
            employment TEXT,
            schedule TEXT,
            search_timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        );

        CREATE TABLE vacancies (
            id TEXT PRIMARY KEY,
            name TEXT NOT NULL,
            employer_name TEXT,
            salary_from INT,
            salary_to INT,
            salary_currency TEXT,
            area_name TEXT,
            experience_name TEXT,
            employment_name TEXT,
            schedule_name TEXT,
            alternate_url TEXT,
            query_id INT REFERENCES search_queries(id) ON DELETE CASCADE,
            salary_range TEXT CHECK (salary_range IN ('range_1', 'range_2', 'range_3', 'range_4', 'no_salary'))
        );

        CREATE TABLE skills (
            id SERIAL PRIMARY KEY,
            vacancy_id TEXT REFERENCES vacancies(id) ON DELETE CASCADE,
            skill_name TEXT NOT NULL
        );</code></pre>

                    <h3>Запрос для анализа навыков</h3>
                    <pre><code class="language-sql">-- Получение статистики навыков с группировкой по зарплатным диапазонам
        SELECT 
            s.skill_name, 
            v.salary_range,
            COUNT(*) as count
        FROM skills s
        JOIN vacancies v ON s.vacancy_id = v.id
        WHERE v.query_id = $1
        GROUP BY s.skill_name, v.salary_range
        ORDER BY count DESC, s.skill_name;</code></pre>
                </div>
            </div>
        </div>

        <script>
        // Функции для управления модальным окном с кодом
        function showCodeSnippets() {
            document.getElementById('codeModal').style.display = 'block';
        }

        function closeCodeModal() {
            document.getElementById('codeModal').style.display = 'none';
        }

        function openTab(evt, tabName) {
            const tabcontent = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove('active');
            }
            
            const tabbuttons = document.getElementsByClassName('tab-button');
            for (let i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].classList.remove('active');
            }
            
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');
        }

        // Закрытие модального окна при клике вне его
        window.onclick = function(event) {
            const modal = document.getElementById('codeModal');
            if (event.target === modal) {
                closeCodeModal();
            }
        }
        </script>

        <style>
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            overflow-y: auto;
        }

        .close {
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .code-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }

        .tab-button {
            padding: 10px 20px;
            background: #f1f1f1;
            border: none;
            cursor: pointer;
            margin-right: 5px;
            border-radius: 5px 5px 0 0;
        }

        .tab-button.active {
            background: #3498db;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
        }

        code {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
        }
        </style>

        <!-- Модальное окно для показа кода магазина -->
        <div id="shopCodeModal" class="modal">
            <div class="modal-content" style="max-width: 800px; max-height: 80vh;">
                <span class="close" onclick="closeShopCodeModal()">&times;</span>
                <h2>Ключевые фрагменты кода интернет-магазина</h2>
                <div class="code-tabs">
                    <button class="tab-button active" onclick="openShopTab(event, 'shopFrontendTab')">Frontend (HTML/CSS/JS)</button>
                    <button class="tab-button" onclick="openShopTab(event, 'shopBackendTab')">Backend (PHP)</button>
                    <button class="tab-button" onclick="openShopTab(event, 'shopDatabaseTab')">База данных</button>
                </div>
                
                <div id="shopFrontendTab" class="tab-content active">
                    <h3>Корзина покупок (JavaScript)</h3>
                    <pre><code class="language-javascript">// Инициализация корзины
        let cart = JSON.parse(localStorage.getItem('cart')) || [];

        function addToCart(productId, quantity = 1) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    image: product.image,
                    quantity: quantity
                });
            }
            
            updateCart();
            saveCartToStorage();
            showNotification('Товар добавлен в корзину!');
        }

        function updateCart() {
            const cartCount = document.querySelector('.cart-count');
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;
            
            updateCartModal();
        }

        function updateCartModal() {
            const cartItemsContainer = document.querySelector('.cart-items');
            const cartTotal = document.querySelector('.cart-total');
            
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="empty-cart">Корзина пуста</p>';
                cartTotal.textContent = 'Итого: 0 ₽';
                return;
            }
            
            let itemsHTML = '';
            let total = 0;
            
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
            });
            
            cartItemsContainer.innerHTML = itemsHTML;
            cartTotal.textContent = `Итого: ${total.toLocaleString()} ₽`;
        }

        function saveCartToStorage() {
            localStorage.setItem('cart', JSON.stringify(cart));
        }</code></pre>

                    <h3>Обработка оформления заказа</h3>
                    <pre><code class="language-javascript">function processCheckout() {
            if (cart.length === 0) {
                showError('Корзина пуста');
                return;
            }
            
            const formData = new FormData(document.getElementById('checkout-form'));
            const orderData = {
                customer: Object.fromEntries(formData),
                items: cart,
                total: calculateTotal(),
                orderDate: new Date().toISOString(),
                status: 'pending'
            };
            
            fetch('/api/orders', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(orderData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    clearCart();
                    showOrderConfirmation(data.orderId);
                } else {
                    showError('Ошибка при оформлении заказа');
                }
            })
            .catch(error => {
                showError('Ошибка сети: ' + error.message);
            });
        }

        function calculateTotal() {
            return cart.reduce((total, item) => total + (item.price * item.quantity), 0);
        }</code></pre>
                </div>
                
                <div id="shopBackendTab" class="tab-content">
                    <h3>Обработка заказов (PHP)</h3>
                    <pre><code class="language-php"><?php
        class OrderController {
            public function createOrder($request) {
                try {
                    $data = json_decode($request, true);
                    
                    if (!$this->validateOrderData($data)) {
                        return json_encode(['success' => false, 'error' => 'Неверные данные заказа']);
                    }
                    
                    $orderId = $this->generateOrderId();
                    $orderData = [
                        'order_id' => $orderId,
                        'customer_name' => $data['customer']['name'],
                        'customer_email' => $data['customer']['email'],
                        'customer_phone' => $data['customer']['phone'],
                        'customer_address' => $data['customer']['address'],
                        'items' => json_encode($data['items']),
                        'total_amount' => $data['total'],
                        'status' => 'pending',
                        'created_at' => date('Y-m-d H:i:s')
                    ];
                    
                    $result = $this->saveOrderToDatabase($orderData);
                    
                    if ($result) {
                        $this->sendConfirmationEmail($orderData);
                        return json_encode([
                            'success' => true, 
                            'orderId' => $orderId,
                            'message' => 'Заказ успешно создан'
                        ]);
                    } else {
                        return json_encode(['success' => false, 'error' => 'Ошибка сохранения заказа']);
                    }
                    
                } catch (Exception $e) {
                    return json_encode(['success' => false, 'error' => $e->getMessage()]);
                }
            }
            
            private function validateOrderData($data) {
                return isset($data['customer'], $data['items'], $data['total']) &&
                    !empty($data['customer']['email']) &&
                    !empty($data['customer']['phone']) &&
                    !empty($data['items']) &&
                    $data['total'] > 0;
            }
            
            private function generateOrderId() {
                return 'ORD' . date('Ymd') . strtoupper(uniqid());
            }
        }
        ?></code></pre>

                    <h3>Работа с товарами (PHP)</h3>
                    <pre><code class="language-php"><?php
        class ProductController {
            private $db;
            
            public function __construct($database) {
                $this->db = $database;
            }
            
            public function getAllProducts($filters = []) {
                $query = "SELECT * FROM products WHERE status = 'active'";
                $params = [];
                
                if (!empty($filters['category'])) {
                    $query .= " AND category = ?";
                    $params[] = $filters['category'];
                }
                
                if (!empty($filters['search'])) {
                    $query .= " AND (name LIKE ? OR description LIKE ?)";
                    $searchTerm = "%{$filters['search']}%";
                    $params[] = $searchTerm;
                    $params[] = $searchTerm;
                }
                
                $query .= " ORDER BY created_at DESC";
                
                $stmt = $this->db->prepare($query);
                $stmt->execute($params);
                
                return $stmt->fetchAll(PDO::FETCH_ASSOC);
            }
            
            public function getProductById($productId) {
                $stmt = $this->db->prepare("SELECT * FROM products WHERE id = ? AND status = 'active'");
                $stmt->execute([$productId]);
                
                return $stmt->fetch(PDO::FETCH_ASSOC);
            }
            
            public function updateProductStock($productId, $quantity) {
                $stmt = $this->db->prepare("UPDATE products SET stock = stock - ? WHERE id = ? AND stock >= ?");
                return $stmt->execute([$quantity, $productId, $quantity]);
            }
        }
        ?></code></pre>
                </div>
                
                <div id="shopDatabaseTab" class="tab-content">
                    <h3>Схема базы данных магазина</h3>
                    <pre><code class="language-sql">-- Таблица товаров
        CREATE TABLE products (
            id INT AUTO_INCREMENT PRIMARY KEY,
            name VARCHAR(255) NOT NULL,
            description TEXT,
            price DECIMAL(10, 2) NOT NULL,
            category VARCHAR(100) NOT NULL,
            image_url VARCHAR(500),
            stock INT DEFAULT 0,
            status ENUM('active', 'inactive') DEFAULT 'active',
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
            updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
        );

        -- Таблица заказов
        CREATE TABLE orders (
            id INT AUTO_INCREMENT PRIMARY KEY,
            order_id VARCHAR(50) UNIQUE NOT NULL,
            customer_name VARCHAR(255) NOT NULL,
            customer_email VARCHAR(255) NOT NULL,
            customer_phone VARCHAR(50) NOT NULL,
            customer_address TEXT NOT NULL,
            total_amount DECIMAL(10, 2) NOT NULL,
            status ENUM('pending', 'processing', 'shipped', 'delivered', 'cancelled') DEFAULT 'pending',
            payment_status ENUM('pending', 'paid', 'failed') DEFAULT 'pending',
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
            updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
        );

        -- Таблица элементов заказа
        CREATE TABLE order_items (
            id INT AUTO_INCREMENT PRIMARY KEY,
            order_id INT NOT NULL,
            product_id INT NOT NULL,
            product_name VARCHAR(255) NOT NULL,
            product_price DECIMAL(10, 2) NOT NULL,
            quantity INT NOT NULL,
            total_price DECIMAL(10, 2) NOT NULL,
            FOREIGN KEY (order_id) REFERENCES orders(id) ON DELETE CASCADE,
            FOREIGN KEY (product_id) REFERENCES products(id) ON DELETE SET NULL
        );

        -- Таблица пользователей
        CREATE TABLE users (
            id INT AUTO_INCREMENT PRIMARY KEY,
            email VARCHAR(255) UNIQUE NOT NULL,
            password_hash VARCHAR(255) NOT NULL,
            full_name VARCHAR(255) NOT NULL,
            phone VARCHAR(50),
            address TEXT,
            role ENUM('customer', 'admin') DEFAULT 'customer',
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
            last_login TIMESTAMP NULL
        );</code></pre>

                    <h3>Пример запроса для получения заказов</h3>
                    <pre><code class="language-sql">-- Получение заказов с информацией о товарах
        SELECT 
            o.order_id,
            o.customer_name,
            o.customer_email,
            o.total_amount,
            o.status,
            o.created_at,
            GROUP_CONCAT(oi.product_name) as products,
            COUNT(oi.id) as items_count
        FROM orders o
        LEFT JOIN order_items oi ON o.id = oi.order_id
        WHERE o.status = 'pending'
        GROUP BY o.id
        ORDER BY o.created_at DESC
        LIMIT 10;</code></pre>
                </div>
            </div>
        </div>

        <script>
        // Функции для управления модальным окном с кодом магазина
        function showShopCodeSnippets() {
            document.getElementById('shopCodeModal').style.display = 'block';
        }

        function closeShopCodeModal() {
            document.getElementById('shopCodeModal').style.display = 'none';
        }

        function openShopTab(evt, tabName) {
            const tabcontent = document.querySelectorAll('#shopCodeModal .tab-content');
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove('active');
            }
            
            const tabbuttons = document.querySelectorAll('#shopCodeModal .tab-button');
            for (let i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].classList.remove('active');
            }
            
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');
        }

        // Закрытие модального окна при клике вне его
        window.onclick = function(event) {
            const modal = document.getElementById('shopCodeModal');
            if (event.target === modal) {
                closeShopCodeModal();
            }
        }
        </script>

        <!-- Модальное окно для показа кода базы данных клиентов -->
        <div id="dbCodeModal" class="modal">
            <div class="modal-content" style="max-width: 800px; max-height: 80vh;">
                <span class="close" onclick="closeDBCodeModal()">&times;</span>
                <h2>Ключевые фрагменты кода системы управления клиентами</h2>
                <div class="code-tabs">
                    <button class="tab-button active" onclick="openDBTab(event, 'dbBackendTab')">Backend (Python/Flask)</button>
                    <button class="tab-button" onclick="openDBTab(event, 'dbFrontendTab')">Frontend (JS)</button>
                    <button class="tab-button" onclick="openDBTab(event, 'dbDatabaseTab')">База данных</button>
                </div>
                
                <div id="dbBackendTab" class="tab-content active">
                    <h3>Модели данных (SQLAlchemy)</h3>
                    <pre><code class="language-python">from app import db
        from datetime import datetime
        from flask_login import UserMixin

        class User(db.Model, UserMixin):
            id = db.Column(db.Integer, primary_key=True)
            username = db.Column(db.String(50), unique=True, nullable=False)
            password = db.Column(db.String(100), nullable=False)
            role = db.Column(db.String(10), default='user')
            
            def __repr__(self):
                return f"User('{self.username}', '{self.role}')"

        class Client(db.Model):
            id = db.Column(db.Integer, primary_key=True)
            first_name = db.Column(db.String(50))
            last_name = db.Column(db.String(50))
            email = db.Column(db.String(100))
            phone = db.Column(db.String(20))
            company = db.Column(db.String(100))
            created_at = db.Column(db.DateTime, default=datetime.utcnow)
            created_by = db.Column(db.Integer, db.ForeignKey('user.id'))
            
            def __repr__(self):
                return f"Client('{self.first_name}', '{self.last_name}')"

        class ClientHistory(db.Model):
            id = db.Column(db.Integer, primary_key=True)
            client_id = db.Column(db.Integer, db.ForeignKey('client.id'))
            changed_by = db.Column(db.Integer, db.ForeignKey('user.id'))
            change_type = db.Column(db.String(20))
            change_timestamp = db.Column(db.DateTime, default=datetime.utcnow)
            change_details = db.Column(db.Text)</code></pre>

                    <h3>API для работы с клиентами</h3>
                    <pre><code class="language-python">@client_routes.route('/clients')
        @login_required
        def clients_list():
            page = request.args.get('page', 1, type=int)
            search = request.args.get('search', '')
            
            query = Client.query
            if search:
                query = query.filter(Client.first_name.ilike(f'%{search}%') | 
                                Client.last_name.ilike(f'%{search}%') |
                                Client.company.ilike(f'%{search}%'))
            
            clients = query.paginate(page=page, per_page=10)
            return render_template('clients.html', clients=clients, search=search)

        @client_routes.route('/client/add', methods=['GET', 'POST'])
        @login_required
        def add_client():
            form = ClientForm()
            if form.validate_on_submit():
                client = Client(
                    first_name=form.first_name.data,
                    last_name=form.last_name.data,
                    email=form.email.data,
                    phone=form.phone.data,
                    company=form.company.data,
                    created_by=current_user.id
                )
                db.session.add(client)
                db.session.commit()
                
                # Запись в историю
                history = ClientHistory(
                    client_id=client.id,
                    changed_by=current_user.id,
                    change_type='create',
                    change_details=json.dumps({'action': 'Client created'})
                )
                db.session.add(history)
                db.session.commit()
                
                flash('Client added successfully', 'success')
                return redirect(url_for('clients.clients_list'))
            
            return render_template('add_client.html', form=form)</code></pre>
                </div>
                
                <div id="dbFrontendTab" class="tab-content">
                    <h3>Обработка фильтров и поиска</h3>
                    <pre><code class="language-javascript">function applyClientFilters() {
            const filters = {
                search: document.getElementById('searchInput').value,
                status: document.getElementById('statusFilter').value,
                company: document.getElementById('companyFilter').value,
                sortBy: document.getElementById('sortBy').value,
                sortOrder: document.getElementById('sortOrder').value
            };

            // Показ индикатора загрузки
            showLoadingIndicator();
            
            // Отправка запроса на сервер
            fetch('/api/clients', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(filters)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    renderClientsTable(data.clients);
                    updatePagination(data.pagination);
                } else {
                    showError(data.message);
                }
            })
            .catch(error => {
                showError('Ошибка сети: ' + error.message);
            })
            .finally(() => {
                hideLoadingIndicator();
            });
        }

        function renderClientsTable(clients) {
            const tableBody = document.getElementById('clientsTableBody');
            tableBody.innerHTML = '';
            
            clients.forEach(client => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${client.id}</td>
                    <td>${client.first_name} ${client.last_name}</td>
                    <td>${client.email}</td>
                    <td>${client.phone}</td>
                    <td>${client.company}</td>
                `;
                tableBody.appendChild(row);
            });
            
            // Добавляем обработчики событий для кнопок
            attachClientEventHandlers();
        }</code></pre>

                    <h3>Экспорт данных</h3>
                    <pre><code class="language-javascript">function exportClients(format) {
            const filters = getCurrentFilters();
            
            fetch(`/api/export/clients/${format}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(filters)
            })
            .then(response => response.blob())
            .then(blob => {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = `clients_export.${format}`;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                showNotification(`Данные экспортированы в формате ${format.toUpperCase()}`);
            })
            .catch(error => {
                showError('Ошибка при экспорте: ' + error.message);
            });
        }</code></pre>
                </div>
                
                <div id="dbDatabaseTab" class="tab-content">
                    <h3>Схема базы данных</h3>
                    <pre><code class="language-sql">-- Таблица пользователей
        CREATE TABLE users (
            id INT PRIMARY KEY AUTO_INCREMENT,
            username VARCHAR(50) UNIQUE NOT NULL,
            password VARCHAR(100) NOT NULL,
            role ENUM('admin', 'user') DEFAULT 'user',
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        );

        -- Таблица клиентов
        CREATE TABLE clients (
            id INT PRIMARY KEY AUTO_INCREMENT,
            first_name VARCHAR(50),
            last_name VARCHAR(50),
            email VARCHAR(100),
            phone VARCHAR(20),
            company VARCHAR(100),
            status ENUM('active', 'inactive', 'prospect') DEFAULT 'prospect',
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
            created_by INT,
            FOREIGN KEY (created_by) REFERENCES users(id)
        );

        -- Таблица истории изменений
        CREATE TABLE client_history (
            id INT PRIMARY KEY AUTO_INCREMENT,
            client_id INT,
            changed_by INT,
            change_type VARCHAR(20),
            change_timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
            change_details TEXT,
            FOREIGN KEY (client_id) REFERENCES clients(id) ON DELETE CASCADE,
            FOREIGN KEY (changed_by) REFERENCES users(id)
        );

        -- Индексы для улучшения производительности
        CREATE INDEX idx_clients_name ON clients(first_name, last_name);
        CREATE INDEX idx_clients_company ON clients(company);
        CREATE INDEX idx_clients_status ON clients(status);
        CREATE INDEX idx_client_history ON client_history(client_id, change_timestamp);</code></pre>

                    <h3>Пример запроса для аналитики</h3>
                    <pre><code class="language-sql">-- Получение статистики по клиентам по компаниям
        SELECT 
            company,
            COUNT(*) as total_clients,
            SUM(CASE WHEN status = 'active' THEN 1 ELSE 0 END) as active_clients,
            SUM(CASE WHEN status = 'inactive' THEN 1 ELSE 0 END) as inactive_clients,
            SUM(CASE WHEN status = 'prospect' THEN 1 ELSE 0 END) as prospect_clients,
            ROUND((SUM(CASE WHEN status = 'active' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) as active_percentage
        FROM clients
        GROUP BY company
        HAVING COUNT(*) > 0
        ORDER BY total_clients DESC;

        -- Получение истории изменений клиента
        SELECT 
            ch.change_timestamp,
            u.username as changed_by,
            ch.change_type,
            ch.change_details
        FROM client_history ch
        JOIN users u ON ch.changed_by = u.id
        WHERE ch.client_id = 123
        ORDER BY ch.change_timestamp DESC;</code></pre>
                </div>
            </div>
        </div>

        <script>
        // Функции для управления модальным окном с кодом базы данных
        function showDBCodeSnippets() {
            document.getElementById('dbCodeModal').style.display = 'block';
        }

        function closeDBCodeModal() {
            document.getElementById('dbCodeModal').style.display = 'none';
        }

        function openDBTab(evt, tabName) {
            const tabcontent = document.querySelectorAll('#dbCodeModal .tab-content');
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove('active');
            }
            
            const tabbuttons = document.querySelectorAll('#dbCodeModal .tab-button');
            for (let i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].classList.remove('active');
            }
            
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');
        }

        // Закрытие модального окна при клике вне его
        window.onclick = function(event) {
            const modal = document.getElementById('dbCodeModal');
            if (event.target === modal) {
                closeDBCodeModal();
            }
        }
        </script>

    <script src="script.js"></script>
</body>
</html>